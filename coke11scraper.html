<html>
  <head>
    <title>Coke11's Scraper</title>
    <script>
      function scrapeComments(id, offset){
        var url = "https://crossorigin.me/" + "https://scratch.mit.edu/site-api/comments/project/" + id + "/?page=" + offset; 
        var xhttp = new XMLHttpRequest(); //Create an AJAX object
        xhttp.open("GET", url); //Open a request with the URL calculated
        xhttp.onreadystatechange = function(){ //When the status of the connection changes
          if(xhttp.readyState == 4){ //Check that it has loaded and that it loaded it succesfully
            if(xhttp.status == 200){
              /* xhttp.responseText stores the HTML data */
              var data = document.createElement("DIV");
              data.innerHTML = xhttp.responseText;
              document.getElementById("playground").appendChild(data);
              document.setTimeout(scrapeComments, 50)
          } else if (status == 404){
            var comments = toArray(document.querySelectorAll("#playground > div > li > div > .info > .content")).map(function(el){return el.innerHTML;});
            var posters = toArray(document.querySelectorAll("#playground > div > li > div > .info > .name > a")).map(function(el){return el.innerHTML;});
            console.log(posters);
          }
        }
        xhttp.send();
      }
      function toArray(likeObj){
        var out = [];
        for(var i = 0; i < likeObj.length; i++){
          out.push(likeObj[i]);
        }
        return out;
      }
    </script>
  </head>
  <body>
    <div id="playground" height="0" width="0" style="display: none;"></div>
    <center>Use the field below. It has a template built-in: use it if you like!<br/>
    <textarea rows="10" cols="20"><h1>@username</h1>
"@comment"</textarea><br/>
    Older comments appear at the <select><option vaue="top">top</option><option vaue="bot">bottom</option></select> of the page.
    <button>Do It!</button>
    <table border="1">
      <tbody>
        <tr><td><b>Code</b></td><td><b>Meaning</b></td></tr>
        <tr><td>@username</td><td>A linked username to the profile of the person who made the comment</td></tr>
        <tr><td>@unlinked</td><td>An ulinked username of the person who made the comment</td></tr>
        <tr><td>@comment</td><td>The text within the comment</td></tr>
      </tbody>
    </table>
    </center>
  </body>
</html>
